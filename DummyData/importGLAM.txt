// Importing GLAM Items
// Thanks to: 
// http://jexp.de/blog/2014/06/load-csv-into-neo4j-quickly-and-successfully/
// for help with loading, finding the path and placing constraints

// STEP 1: Place unique constraint since each classifiable name - must be unique
CREATE CONSTRAINT ON (c:Classifiable) ASSERT c.name IS UNIQUE;

// STEP 2: Load the Classifiables, if unique rule is exploited, just merge 
USING PERIODIC COMMIT 1000
LOAD CSV WITH HEADERS FROM 
"file:c:/Users/Bronte/Desktop/DummyData/sampleGLAM.csv"
AS line
MERGE (c:Classifiable {name:line.ItemName})
ON CREATE SET c.name = line.ItemName,  c.url = line.Url

// STEP 3: Add Concept Strings and connect to Classifiables 
USING PERIODIC COMMIT 1000
LOAD CSV WITH HEADERS FROM 
"file:c:/Users/Bronte/Desktop/DummyData/sampleGLAM.csv"
AS line
MATCH (c:Classifiable {name:line.ItemName})
MERGE (cs:ConceptString {name:line.ConceptString})
CREATE (c)-[:CLASSIFIED_TERMS]->(cs)

// STEP OPTIONAL: Link Users with their Classifiables
USING PERIODIC COMMIT 1000
LOAD CSV WITH HEADERS FROM 
"file:c:/Users/Bronte/Desktop/DummyData/sampleGLAM.csv"
AS line
MATCH (c:Classifiable {name:line.ItemName})
MATCH (u:Classifier {name:line.ClassifierName})
CREATE (c)-[:CLASSIFIED_BY]->(u)

// Updating Urls on Classifiables to actual Urls
USING PERIODIC COMMIT 1000
LOAD CSV WITH HEADERS FROM 
"file:c:/Users/Bronte/Source/Repos/ClassyDev/DummyData/sampleGLAM.csv"
AS line
MATCH (c:Classifiable {name:line.ItemName})
SET  c.url = line.Url

